services:
  voxcpm:
    image: neosun/voxcpm-allinone:1.0.0
    container_name: voxcpm-service
    runtime: nvidia
    environment:
      - NVIDIA_VISIBLE_DEVICES=${NVIDIA_VISIBLE_DEVICES:-0}
      - PORT=${PORT:-7861}
      - GPU_IDLE_TIMEOUT=${GPU_IDLE_TIMEOUT:-60}
      - HF_REPO_ID=${HF_REPO_ID:-openbmb/VoxCPM1.5}
    ports:
      - "0.0.0.0:${PORT:-7861}:7861"
    volumes:
      - /tmp/voxcpm-tts/uploads:/app/uploads
      - /tmp/voxcpm-tts/outputs:/app/outputs
      - voxcpm-models:/app/models
      - voxcpm-hf-cache:/root/.cache/huggingface
      - voxcpm-ms-cache:/root/.cache/modelscope
    restart: unless-stopped
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]

volumes:
  voxcpm-models:
  voxcpm-hf-cache:
  voxcpm-ms-cache:
