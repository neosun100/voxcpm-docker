# VoxCPM å‚æ•°å®Œæ•´å¯¹ç…§è¡¨

## ğŸ“‹ æ‰€æœ‰å¯ç”¨å‚æ•°

### æ ¸å¿ƒå‚æ•°

| å‚æ•°å | ç±»å‹ | é»˜è®¤å€¼ | èŒƒå›´ | è¯´æ˜ | UI | API | MCP |
|--------|------|--------|------|------|-----|-----|-----|
| `text` | string | - | - | è¦åˆæˆçš„æ–‡æœ¬ | âœ… | âœ… | âœ… |
| `prompt_wav_path` | string | None | - | å‚è€ƒéŸ³é¢‘è·¯å¾„ï¼ˆå£°éŸ³å…‹éš†ï¼‰ | âœ… | âœ… | âœ… |
| `prompt_text` | string | None | - | å‚è€ƒéŸ³é¢‘çš„æ–‡æœ¬è½¬å½• | âœ… | âœ… | âœ… |

### ç”Ÿæˆæ§åˆ¶å‚æ•°

| å‚æ•°å | ç±»å‹ | é»˜è®¤å€¼ | èŒƒå›´ | è¯´æ˜ | UI | API | MCP |
|--------|------|--------|------|------|-----|-----|-----|
| `cfg_value` | float | 2.0 | 0.5-5.0 | å¼•å¯¼å¼ºåº¦ï¼Œè¶Šé«˜è¶Šè´´è¿‘æç¤º | âœ… | âœ… | âœ… |
| `inference_timesteps` | int | 10 | 5-20 | æ¨ç†æ­¥æ•°ï¼Œè¶Šé«˜è´¨é‡è¶Šå¥½ä½†è¶Šæ…¢ | âœ… | âœ… | âœ… |
| `min_len` | int | 2 | 1-100 | æœ€å° token é•¿åº¦ | âœ… | âœ… | âœ… |
| `max_len` | int | 4096 | 100-8192 | æœ€å¤§ token é•¿åº¦ | âœ… | âœ… | âœ… |

### å¤„ç†é€‰é¡¹

| å‚æ•°å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ | UI | API | MCP |
|--------|------|--------|------|-----|-----|-----|
| `normalize` | bool | False | å¯ç”¨æ–‡æœ¬è§„èŒƒåŒ– | âœ… | âœ… | âœ… |
| `denoise` | bool | False | å¯ç”¨éŸ³é¢‘é™å™ª | âœ… | âœ… | âœ… |

### é‡è¯•æœºåˆ¶å‚æ•°

| å‚æ•°å | ç±»å‹ | é»˜è®¤å€¼ | èŒƒå›´ | è¯´æ˜ | UI | API | MCP |
|--------|------|--------|------|------|-----|-----|-----|
| `retry_badcase` | bool | True | - | å¯ç”¨åæƒ…å†µé‡è¯•ï¼ˆæ— æ³•åœæ­¢çš„ç”Ÿæˆï¼‰ | âœ… | âœ… | âœ… |
| `retry_badcase_max_times` | int | 3 | 1-10 | æœ€å¤§é‡è¯•æ¬¡æ•° | âœ… | âœ… | âœ… |
| `retry_badcase_ratio_threshold` | float | 6.0 | 1.0-20.0 | éŸ³é¢‘æ–‡æœ¬æ¯”ç‡é˜ˆå€¼ï¼Œç”¨äºæ£€æµ‹åæƒ…å†µ | âœ… | âœ… | âœ… |

---

## ğŸ¯ å‚æ•°è¯¦è§£

### 1. cfg_valueï¼ˆå¼•å¯¼å¼ºåº¦ï¼‰

**ä½œç”¨**ï¼šæ§åˆ¶ç”Ÿæˆç»“æœä¸æç¤ºçš„è´´åˆç¨‹åº¦

| å€¼ | æ•ˆæœ | é€‚ç”¨åœºæ™¯ |
|----|------|----------|
| 0.5-1.5 | æ›´è‡ªç„¶ï¼Œä½†å¯èƒ½åç¦»æç¤º | åˆ›æ„ç”Ÿæˆ |
| 1.5-2.5 | å¹³è¡¡ï¼Œæ¨èä½¿ç”¨ | ä¸€èˆ¬ä½¿ç”¨ â­ |
| 2.5-5.0 | ä¸¥æ ¼éµå¾ªæç¤ºï¼Œä½†å¯èƒ½ä¸è‡ªç„¶ | ç²¾ç¡®å…‹éš† |

### 2. inference_timestepsï¼ˆæ¨ç†æ­¥æ•°ï¼‰

**ä½œç”¨**ï¼šæ§åˆ¶ç”Ÿæˆè´¨é‡å’Œé€Ÿåº¦

| å€¼ | è´¨é‡ | é€Ÿåº¦ | RTF (RTX 4090) | é€‚ç”¨åœºæ™¯ |
|----|------|------|----------------|----------|
| 5 | è¾ƒä½ | æœ€å¿« | ~0.08 | å¿«é€Ÿé¢„è§ˆ |
| 10 | è‰¯å¥½ | å¹³è¡¡ | ~0.15 | æ¨èä½¿ç”¨ â­ |
| 15 | ä¼˜ç§€ | è¾ƒæ…¢ | ~0.22 | é«˜è´¨é‡è¾“å‡º |
| 20 | æœ€ä½³ | æœ€æ…¢ | ~0.30 | ä¸“ä¸šåˆ¶ä½œ |

### 3. min_len / max_lenï¼ˆé•¿åº¦æ§åˆ¶ï¼‰

**ä½œç”¨**ï¼šæ§åˆ¶ç”ŸæˆéŸ³é¢‘çš„é•¿åº¦èŒƒå›´

- `min_len`: æœ€å° token æ•°ï¼Œé˜²æ­¢ç”Ÿæˆè¿‡çŸ­
- `max_len`: æœ€å¤§ token æ•°ï¼Œé˜²æ­¢ç”Ÿæˆè¿‡é•¿æˆ–æ— æ³•åœæ­¢

**æ¨èè®¾ç½®**ï¼š
- çŸ­å¥ï¼š`min_len=2, max_len=1024`
- ä¸­ç­‰ï¼š`min_len=2, max_len=4096` â­
- é•¿æ–‡ï¼š`min_len=2, max_len=8192`

### 4. normalizeï¼ˆæ–‡æœ¬è§„èŒƒåŒ–ï¼‰

**ä½œç”¨**ï¼šå°†æ–‡æœ¬è½¬æ¢ä¸ºæ ‡å‡†æ ¼å¼

**æ•ˆæœ**ï¼š
- æ•°å­—è½¬æ–‡å­—ï¼š`123` â†’ `ä¸€ç™¾äºŒåä¸‰`
- ç¬¦å·å¤„ç†ï¼š`$100` â†’ `ä¸€ç™¾ç¾å…ƒ`
- ç¼©å†™å±•å¼€ï¼š`Dr.` â†’ `Doctor`

**å»ºè®®**ï¼š
- âœ… å¯ç”¨ï¼šåŒ…å«æ•°å­—ã€ç¬¦å·ã€ç¼©å†™çš„æ–‡æœ¬
- âŒ ç¦ç”¨ï¼šå·²ç»è§„èŒƒåŒ–çš„æ–‡æœ¬ã€éœ€è¦ä¿ç•™åŸå§‹æ ¼å¼

### 5. denoiseï¼ˆéŸ³é¢‘é™å™ªï¼‰

**ä½œç”¨**ï¼šå¯¹å‚è€ƒéŸ³é¢‘è¿›è¡Œé™å™ªå¤„ç†

**æ•ˆæœ**ï¼š
- å»é™¤èƒŒæ™¯å™ªéŸ³
- æå‡å£°éŸ³æ¸…æ™°åº¦
- æ”¹å–„å…‹éš†è´¨é‡

**å»ºè®®**ï¼š
- âœ… å¯ç”¨ï¼šå‚è€ƒéŸ³é¢‘æœ‰å™ªéŸ³
- âŒ ç¦ç”¨ï¼šå‚è€ƒéŸ³é¢‘å·²ç»å¾ˆå¹²å‡€ï¼ˆé¿å…è¿‡åº¦å¤„ç†ï¼‰

### 6. retry_badcaseï¼ˆé‡è¯•æœºåˆ¶ï¼‰

**ä½œç”¨**ï¼šè‡ªåŠ¨æ£€æµ‹å¹¶é‡è¯•æ— æ³•åœæ­¢çš„ç”Ÿæˆ

**å·¥ä½œåŸç†**ï¼š
1. æ£€æµ‹éŸ³é¢‘é•¿åº¦ä¸æ–‡æœ¬é•¿åº¦çš„æ¯”ç‡
2. å¦‚æœæ¯”ç‡è¶…è¿‡ `retry_badcase_ratio_threshold`ï¼Œåˆ¤å®šä¸ºåæƒ…å†µ
3. è‡ªåŠ¨é‡è¯•ï¼Œæœ€å¤š `retry_badcase_max_times` æ¬¡

**å‚æ•°è°ƒä¼˜**ï¼š
- `retry_badcase_ratio_threshold=6.0`ï¼šé»˜è®¤å€¼ï¼Œé€‚åˆå¤§å¤šæ•°æƒ…å†µ
- å¢å¤§é˜ˆå€¼ï¼šå…è®¸æ›´é•¿çš„éŸ³é¢‘ï¼ˆé€‚åˆæ…¢é€Ÿè¯­éŸ³ï¼‰
- å‡å°é˜ˆå€¼ï¼šæ›´ä¸¥æ ¼çš„æ£€æµ‹ï¼ˆé€‚åˆå¿«é€Ÿè¯­éŸ³ï¼‰

---

## ğŸ“Š ä½¿ç”¨åœºæ™¯æ¨è

### åœºæ™¯ 1ï¼šå¿«é€Ÿé¢„è§ˆ
```python
cfg_value=1.5
inference_timesteps=5
min_len=2
max_len=1024
normalize=False
denoise=False
retry_badcase=True
```

### åœºæ™¯ 2ï¼šæ—¥å¸¸ä½¿ç”¨ï¼ˆæ¨èï¼‰â­
```python
cfg_value=2.0
inference_timesteps=10
min_len=2
max_len=4096
normalize=True
denoise=False
retry_badcase=True
retry_badcase_max_times=3
retry_badcase_ratio_threshold=6.0
```

### åœºæ™¯ 3ï¼šé«˜è´¨é‡è¾“å‡º
```python
cfg_value=2.5
inference_timesteps=15
min_len=2
max_len=4096
normalize=True
denoise=True
retry_badcase=True
retry_badcase_max_times=5
retry_badcase_ratio_threshold=6.0
```

### åœºæ™¯ 4ï¼šå£°éŸ³å…‹éš†
```python
cfg_value=2.5
inference_timesteps=12
min_len=2
max_len=4096
normalize=True
denoise=True  # å¦‚æœå‚è€ƒéŸ³é¢‘æœ‰å™ªéŸ³
retry_badcase=True
```

---

## ğŸ”§ API è°ƒç”¨ç¤ºä¾‹

### REST API
```bash
curl -X POST http://localhost:7861/api/tts \
  -F "text=æµ‹è¯•æ–‡æœ¬" \
  -F "cfg_value=2.0" \
  -F "inference_timesteps=10" \
  -F "min_len=2" \
  -F "max_len=4096" \
  -F "normalize=true" \
  -F "denoise=false" \
  -F "retry_badcase=true" \
  -F "retry_badcase_max_times=3" \
  -F "retry_badcase_ratio_threshold=6.0" \
  --output output.wav
```

### MCP
```python
result = await mcp_client.call_tool(
    "text_to_speech",
    {
        "text": "æµ‹è¯•æ–‡æœ¬",
        "cfg_value": 2.0,
        "inference_timesteps": 10,
        "min_len": 2,
        "max_len": 4096,
        "normalize": True,
        "denoise": False,
        "retry_badcase": True,
        "retry_badcase_max_times": 3,
        "retry_badcase_ratio_threshold": 6.0
    }
)
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **cfg_value è¿‡é«˜**ï¼šå¯èƒ½å¯¼è‡´ä¸è‡ªç„¶çš„è¯­éŸ³
2. **inference_timesteps è¿‡ä½**ï¼šè´¨é‡ä¸‹é™æ˜æ˜¾
3. **max_len è¿‡å°**ï¼šé•¿æ–‡æœ¬å¯èƒ½è¢«æˆªæ–­
4. **denoise æ»¥ç”¨**ï¼šå¹²å‡€éŸ³é¢‘ä¸éœ€è¦é™å™ªï¼Œå¯èƒ½å¯¼è‡´å¤±çœŸ
5. **retry_threshold è¿‡å°**ï¼šå¯èƒ½è¯¯åˆ¤æ­£å¸¸çš„æ…¢é€Ÿè¯­éŸ³

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å¿«é€Ÿå¯åŠ¨](QUICKSTART.md)
- [å®Œæ•´éƒ¨ç½²](README_DOCKER.md)
- [MCP æŒ‡å—](MCP_GUIDE.md)
